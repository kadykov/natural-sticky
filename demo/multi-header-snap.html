<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>4-Header SnapEagerness Comparison - Natural Sticky</title>
    <link rel="stylesheet" href="style.css" />
    <style>
      body {
        font-family:
          -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu,
          Cantarell, sans-serif;
        line-height: 1.6;
        margin: 0;
        padding: 0;
        background: #fafafa;
      }

      /* 
       * Special positioning for 4-header comparison:
       * We use absolute/fixed positioning instead of relative/sticky to avoid document flow conflicts.
       * When placing multiple headers side-by-side, we don't want them to reserve space in the layout.
       * This allows all 4 headers to coexist at the same vertical position.
       */
      .sticky-header {
        padding: 0.75rem 1rem;
        margin: 0;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        display: flex;
        align-items: center;
        justify-content: space-between;
        font-size: 0.9rem;
        width: 25%;
        box-sizing: border-box; /* Include padding in width calculation */
        position: absolute; /* Remove from document flow entirely */
        top: 0; /* All start at same top position */
      }

      .sticky-header h1 {
        margin: 0;
        font-size: 1.1rem;
        font-weight: 600;
        flex: 1;
      }

      .sticky-header .value {
        font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
        font-size: 0.8rem;
        opacity: 0.9;
        background: rgba(255, 255, 255, 0.2);
        padding: 0.2rem 0.5rem;
        border-radius: 4px;
      }

      .header-natural {
        background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
        color: white;
        left: 0;
      }

      .header-balanced {
        background: linear-gradient(135deg, #007bff 0%, #6610f2 100%);
        color: white;
        left: 25%;
      }

      .header-eager {
        background: linear-gradient(135deg, #ffc107 0%, #fd7e14 100%);
        color: #000;
        left: 50%;
      }

      .header-magnetic {
        background: linear-gradient(135deg, #dc3545 0%, #e83e8c 100%);
        color: white;
        left: 75%;
      }

      .intro-section {
        background: white;
        padding: 2rem;
        margin: 6rem auto 2rem; /* Add top margin to avoid being covered by headers */
        max-width: 800px;
        border-radius: 12px;
        box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
      }

      .intro-section h1 {
        text-align: center;
        color: #333;
        margin-bottom: 1rem;
      }

      .intro-section p {
        text-align: center;
        color: #666;
        font-size: 1.1rem;
      }

      .instructions {
        background: #e3f2fd;
        padding: 1rem;
        border-radius: 8px;
        border-left: 4px solid #2196f3;
        margin: 1.5rem 0;
      }

      .instructions p {
        margin: 0;
        color: #1565c0;
        text-align: left;
      }

      .comparison-guide {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
        gap: 1rem;
        margin: 2rem 0;
      }

      .guide-item {
        padding: 1rem;
        border-radius: 8px;
        text-align: center;
        font-size: 0.9rem;
      }

      .guide-item.natural {
        background: #d4edda;
        border-left: 4px solid #28a745;
        color: #155724;
      }

      .guide-item.balanced {
        background: #cce7ff;
        border-left: 4px solid #007bff;
        color: #004085;
      }

      .guide-item.eager {
        background: #fff3cd;
        border-left: 4px solid #ffc107;
        color: #856404;
      }

      .guide-item.magnetic {
        background: #f5c6cb;
        border-left: 4px solid #dc3545;
        color: #721c24;
      }

      .guide-item strong {
        display: block;
        margin-bottom: 0.5rem;
        font-size: 1rem;
      }

      @media (max-width: 768px) {
        .sticky-header {
          font-size: 0.8rem;
          padding: 0.5rem;
        }

        .sticky-header h1 {
          font-size: 0.9rem;
        }

        .value,
        .sticky-header h1 .long-label {
          display: none; /* Hide long labels on mobile */
        }

        .sticky-header .value {
          font-size: 0.9rem;
          font-weight: bold;
        }
      }
    </style>
  </head>
  <body>
    <header class="sticky-header header-natural" id="header-natural">
      <h1><span class="long-label">üåø Natural </span>(0.0)</h1>
      <span class="value">0.0</span>
    </header>

    <header class="sticky-header header-balanced" id="header-balanced">
      <h1><span class="long-label">‚öñÔ∏è Balanced </span>(1.0)</h1>
      <span class="value">1.0</span>
    </header>

    <header class="sticky-header header-eager" id="header-eager">
      <h1><span class="long-label">‚ö° Eager </span>(2.0)</h1>
      <span class="value">2.0</span>
    </header>

    <header class="sticky-header header-magnetic" id="header-magnetic">
      <h1><span class="long-label">üß≤ Magnetic </span>(3.0)</h1>
      <span class="value">3.0</span>
    </header>

    <main>
      <div class="intro-section">
        <h1>Live 4-Header SnapEagerness Comparison</h1>
        <p>
          All four headers are active simultaneously! Scroll to see how
          different snapEagerness values behave in real-time.
        </p>

        <div class="instructions">
          <p>
            <strong>üí° How to test:</strong> Scroll at different speeds and
            directions. Watch how each header responds to your scrolling. The
            higher the snapEagerness value, the more "eager" the header is to
            snap into position.
          </p>
        </div>

        <div class="comparison-guide">
          <div class="guide-item natural">
            <strong>Natural (0.0)</strong>
            Pure natural movement, may show gaps
          </div>
          <div class="guide-item balanced">
            <strong>Balanced (1.0)</strong>
            Default sweet spot
          </div>
          <div class="guide-item eager">
            <strong>Eager (2.0)</strong>
            Prevents gaps aggressively
          </div>
          <div class="guide-item magnetic">
            <strong>Magnetic (3.0)</strong>
            Intentional snap effect
          </div>
        </div>
      </div>

      <section class="demo-content">
        <h2>üîç What to Observe While Scrolling</h2>

        <h3>1. Natural Movement (0.0) - Green Header</h3>
        <p>
          This header moves exactly with your scroll speed, providing the most
          intuitive experience. Notice how it feels completely connected to your
          scrolling motion.
        </p>
        <ul>
          <li><strong>Pros:</strong> Most natural and intuitive feel</li>
          <li>
            <strong>Cons:</strong> May occasionally show small gaps on very fast
            scrolling
          </li>
          <li>
            <strong>Best for:</strong> Content-focused sites, reading
            experiences
          </li>
        </ul>

        <h3>2. Balanced Default (1.0) - Blue Header</h3>
        <p>
          The default value provides a sweet spot between natural movement and
          gap prevention. It predicts one scroll step ahead for smoother
          transitions.
        </p>
        <ul>
          <li>
            <strong>Pros:</strong> Good balance of natural feel and reliability
          </li>
          <li>
            <strong>Cons:</strong> Very subtle snapping might be noticeable to
            sensitive users
          </li>
          <li><strong>Best for:</strong> Most general-purpose applications</li>
        </ul>

        <h3>3. Eager Prevention (2.0) - Orange Header</h3>
        <p>
          More aggressive gap prevention that predicts two scroll steps ahead.
          Notice the more pronounced snapping behavior.
        </p>
        <ul>
          <li><strong>Pros:</strong> Virtually eliminates visual gaps</li>
          <li><strong>Cons:</strong> More noticeable artificial snapping</li>
          <li>
            <strong>Best for:</strong> Complex interfaces where gaps cause
            layout issues
          </li>
        </ul>

        <h3>4. Magnetic Effect (3.0) - Red Header</h3>
        <p>
          Creates an intentional "magnetic" attraction to the top edge. The
          snapping becomes a deliberate part of the design language.
        </p>
        <ul>
          <li>
            <strong>Pros:</strong> Completely predictable, no gaps, distinctive
            behavior
          </li>
          <li><strong>Cons:</strong> Least natural movement</li>
          <li>
            <strong>Best for:</strong> Gaming interfaces, when snapping is
            desired as a feature
          </li>
        </ul>

        <div class="spacer"></div>

        <h2>üß™ Try These Tests</h2>
        <p>
          <strong>Slow Scrolling:</strong> All headers should feel natural and
          smooth.
        </p>
        <p>
          <strong>Fast Scrolling:</strong> Notice how higher values prevent gaps
          but feel less natural.
        </p>
        <p>
          <strong>Direction Changes:</strong> Quickly reverse scroll direction
          and observe how each header responds.
        </p>
        <p>
          <strong>Momentum Scrolling:</strong> On mobile/trackpad, try flick
          scrolling to see behavior during deceleration.
        </p>

        <div class="spacer"></div>

        <h2>üéØ Making Your Choice</h2>
        <p>The right snapEagerness value depends on your specific use case:</p>

        <h3>Choose 0.0-1.0 when:</h3>
        <ul>
          <li>Natural movement is your top priority</li>
          <li>Building content-focused or reading interfaces</li>
          <li>Users typically scroll at moderate speeds</li>
          <li>You want the least distracting behavior possible</li>
        </ul>

        <h3>Choose 1.5-2.5 when:</h3>
        <ul>
          <li>You have complex header layouts that can't show gaps</li>
          <li>
            Building mobile-first experiences (touch scrolling is often faster)
          </li>
          <li>Visual consistency is more important than naturalness</li>
          <li>
            You have animations or transitions that need reliable positioning
          </li>
        </ul>

        <h3>Choose 3.0+ when:</h3>
        <ul>
          <li>Snapping behavior aligns with your design language</li>
          <li>Building gaming or highly interactive interfaces</li>
          <li>
            You want the header behavior to feel intentional and distinctive
          </li>
          <li>Zero tolerance for any visual gaps or inconsistencies</li>
        </ul>

        <div class="spacer"></div>

        <h2>üìù Implementation</h2>
        <p>Setting snapEagerness is simple:</p>

        <div
          style="
            background: #f8f9fa;
            padding: 1.5rem;
            border-radius: 8px;
            border-left: 4px solid #007bff;
            margin: 1.5rem 0;
            overflow-x: auto;
          "
        >
          <pre><code>// Natural movement
naturalStickyTop(element, { snapEagerness: 0.0 });

// Balanced default (same as omitting the parameter)
naturalStickyTop(element, { snapEagerness: 1.0 });

// Eager gap prevention
naturalStickyTop(element, { snapEagerness: 2.0 });

// Magnetic effect
naturalStickyTop(element, { snapEagerness: 3.0 });</code></pre>
        </div>

        <div class="spacer"></div>

        <p>
          <strong
            >Keep scrolling to continue testing all four behaviors
            simultaneously!</strong
          >
        </p>
        <p>
          This direct comparison eliminates the guesswork - you can immediately
          see and feel the differences between each setting.
        </p>

        <div class="spacer"></div>
      </section>
    </main>

    <script src="../dist/natural-sticky.top.min.js"></script>
    <script>
      document.addEventListener('DOMContentLoaded', () => {
        if (!window.naturalStickyTop) {
          console.error('Natural Sticky library not loaded');
          return;
        }

        // Initialize all four headers with different snapEagerness values
        const headers = [
          { id: 'header-natural', snapEagerness: 0.0 },
          { id: 'header-balanced', snapEagerness: 1.0 },
          { id: 'header-eager', snapEagerness: 2.0 },
          { id: 'header-magnetic', snapEagerness: 3.0 },
        ];

        headers.forEach(({ id, snapEagerness }) => {
          const header = document.getElementById(id);
          if (header) {
            // Use the individual positioning approach
            customNaturalStickyTop(header, { snapEagerness });
          }
        });

        // Custom implementation that maintains individual positioning
        function customNaturalStickyTop(element, options = {}) {
          const { snapEagerness = 1.0 } = options;
          let lastScrollY = window.scrollY;
          let isSticky = false;

          // Store the original left position for all positioning modes
          const computedStyle = window.getComputedStyle(element);
          const originalLeft = computedStyle.left;

          const handleScroll = () => {
            const currentScrollY = window.scrollY;
            const scrollingDown = currentScrollY > lastScrollY;
            const scrollingUp = currentScrollY < lastScrollY;
            const elementHeight = element.offsetHeight;
            const elementRect = element.getBoundingClientRect();
            const isElementVisible =
              elementRect.bottom > 0 && elementRect.top < window.innerHeight;

            // Scroll speed prediction for snapEagerness
            const scrollSpeed = currentScrollY - lastScrollY;
            const shouldBecomeSticky =
              elementRect.top - snapEagerness * scrollSpeed >= 0;

            if (isSticky && scrollingDown) {
              isSticky = false;
              element.style.position = 'absolute';
              element.style.top = `${currentScrollY}px`;
              element.style.left = originalLeft;
            } else if (!isSticky && scrollingUp && !isElementVisible) {
              element.style.position = 'absolute';
              element.style.top = `${currentScrollY - elementHeight}px`;
              element.style.left = originalLeft;
            } else if (!isSticky && shouldBecomeSticky) {
              isSticky = true;
              element.style.position = 'fixed';
              element.style.top = '0';
              element.style.left = originalLeft;
            }

            lastScrollY = currentScrollY > 0 ? currentScrollY : 0;
          };

          // Initial state
          handleScroll();
          window.addEventListener('scroll', handleScroll, { passive: true });

          return {
            destroy: () => {
              window.removeEventListener('scroll', handleScroll);
            },
          };
        }
      });
    </script>
    <script src="drag-scroll.js"></script>
  </body>
</html>
